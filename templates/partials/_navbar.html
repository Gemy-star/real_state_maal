{% load static formatter_tags %}

<nav id="navbar" class="navbar navbar-default navbar-trans navbar-expand-lg fixed-top">
  <div class="container">
    <button class="navbar-toggler collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#navbarDefault" aria-controls="navbarDefault" aria-expanded="false" aria-label="Toggle navigation">
      <span></span>
      <span></span>
      <span></span>
    </button>

    <a class="navbar-brand text-brand" href="{% url 'home-page' %}">
      <img src="{% static 'assets/img/logo_white.png' %}" class="img-fluid" style="max-width:6.5rem; max-height:8vh;" />
    </a>

    <div class="navbar-collapse collapse justify-content-center" id="navbarDefault">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link {% if request.resolver_match.url_name|startswith:'home-page' %} active {% endif %}" href="{% url 'home-page' %}">الرئيسية</a>
        </li>

        <!-- علاقات المستثمرين -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle {% if request.resolver_match.url_name|startswith:'services-page' %} active {% endif %}" href="#" id="investorRelationsDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            علاقات المستثمرين
          </a>
          <ul class="dropdown-menu" style="direction: rtl;" aria-labelledby="investorRelationsDropdown">
            <li><a class="dropdown-item" href="{% url 'reports-page' %}">تقارير مجلس الإدارة</a></li>
            <li><a class="dropdown-item" href="{% url 'services-page' %}">الجمعيات العامة لمساهمين الشركة</a></li>
            <li><a class="dropdown-item" href="{% url 'maal-page' %}">القوائم المالية</a></li>
          </ul>
        </li>

        <!-- الحوكمة -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle {% if request.resolver_match.url_name|startswith:'services-page' %} active {% endif %}" href="#" id="governanceDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            الحوكمة
          </a>
          <ul class="dropdown-menu" style="direction: rtl;" aria-labelledby="governanceDropdown">
            <li><a class="dropdown-item" href="{% static 'assets/thimar_system.pdf' %}">النظام الأساس للشركة</a></li>
            <li><a class="dropdown-item" href="{% url 'privacy-page' %}">سياسة الإبلاغ عن المخالفات</a></li>
            <li><a class="dropdown-item" href="#">سياسة المسؤولية الاجتماعية ومبادرة العمل الاجتماعي</a></li>
          </ul>
        </li>

        <li class="nav-item">
          <a class="nav-link {% if request.resolver_match.url_name|startswith:'who-page' %} active {% endif %}" href="{% url 'who-page' %}">استثماراتنا</a>
        </li>
        <li class="nav-item">
          <a class="nav-link {% if request.resolver_match.url_name|startswith:'about-page' %} active {% endif %}" href="{% url 'about-page' %}">من نحن</a>
        </li>
        <li class="nav-item">
          <a class="nav-link {% if request.resolver_match.url_name|startswith:'contact-page' %} active {% endif %}" href="{% url 'contact-page' %}">المركز الإعلامي</a>
        </li>
      </ul>
    </div>
  </div>
</nav>

<!-- Responsive Dropdown Fix -->
<style>
  @media (max-width: 991px) { /* Bootstrap's breakpoint for navbar collapse */
    .dropdown-menu {
      display: none;
    }
    .dropdown.show .dropdown-menu {
      display: block;
    }
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    // Enable dropdowns to work on mobile by toggling classes
    document.querySelectorAll(".dropdown-toggle").forEach((dropdown) => {
      dropdown.addEventListener("click", function (e) {
        if (window.innerWidth < 992) { // Only apply for mobile screens
          e.preventDefault();
          let parent = this.parentElement;
          parent.classList.toggle("show");
          let menu = parent.querySelector(".dropdown-menu");
          menu.classList.toggle("show");
        }
      });
    });

    // Close dropdown when clicking outside
    document.addEventListener("click", function (e) {
      document.querySelectorAll(".dropdown.show").forEach((dropdown) => {
        if (!dropdown.contains(e.target)) {
          dropdown.classList.remove("show");
          dropdown.querySelector(".dropdown-menu").classList.remove("show");
        }
      });
    });
  });
</script>
